<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Strength from Unity, Conquest from Division | piestyx.dev</title>
<meta name=keywords content="#devlog,#echo"><meta name=description content="Project devlog: Completed a refactor on the project code to create a separation back to two…"><meta name=author content="piestyx"><link rel=canonical href=https://piestyx.dev/blog/devlog-03/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://piestyx.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://piestyx.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://piestyx.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://piestyx.dev/apple-touch-icon.png><link rel=mask-icon href=https://piestyx.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://piestyx.dev/blog/devlog-03/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=https://piestyx.dev/css/custom.css><script src=https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0})</script><meta property="og:url" content="https://piestyx.dev/blog/devlog-03/"><meta property="og:site_name" content="piestyx.dev"><meta property="og:title" content="Strength from Unity, Conquest from Division"><meta property="og:description" content="Project devlog: Completed a refactor on the project code to create a separation back to two…"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-07-09T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-09T00:00:00+00:00"><meta property="article:tag" content="#Devlog"><meta property="article:tag" content="#Echo"><meta name=twitter:card content="summary"><meta name=twitter:title content="Strength from Unity, Conquest from Division"><meta name=twitter:description content="Project devlog: Completed a refactor on the project code to create a separation back to two…"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://piestyx.dev/blog/"},{"@type":"ListItem","position":2,"name":"Strength from Unity, Conquest from Division","item":"https://piestyx.dev/blog/devlog-03/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Strength from Unity, Conquest from Division","name":"Strength from Unity, Conquest from Division","description":"Project devlog: Completed a refactor on the project code to create a separation back to two…","keywords":["#devlog","#echo"],"articleBody":"The Refactor Traptor It is true that refactoring can sometimes be a trap because you don’t actually gain anything from doing it aside from maybe tidying up some messy code or shaving fractions of a second somewhere. My refactor recently, though, was absolutely a value add and a necessity as it was taking up far too much mental bandwidth with a niggling thought in the back of my mind that it still needed to be done. I never intended for it all to be rolled in to one, I wanted to get a baseline together and then build on top of that in a copy so that I always had that baseline template to work off for anything new and I could then also keep that as a local working version instead of using the version that is designed for entertainment. Things iterated rapidly, though, and I didn’t really pay too much attention until later on and it became apparent after a while that it would be best to bite the bullet and spend the time in doing it.\nCreating The Break As I had initially planned on just having a home-AI companion there were hard-coded file paths sitting all over the place, semi finished pieces that I then moved away from and only a semi-separation of concerns and modularity. I had some clear goals in mind for the refactor:\n1. No hard coded pathing - everything must use a `.env` file 2. Each element should work when used in isolation 3. Each element should act in a modular fashion where services such as inference are called when required Fairly simple and logical, and is now a principle I am trying to take across every project because it just makes everything easier to maintain and to grow.\nSo I first went through and moved all pathing, secrets and auths into a .env with an accompanying .env.example. This act alone lifted a huge weight as there were so many different locations for it that it was getting difficult to manage and remember that one place where it might have directly pointed somewhere else. There’s now 35 being tracked in there, which is a lot, but it’s DRY as anything so i’m still satisfied with it. To then propagate them through the development environment I use a single utility python file that loads the .env and provides a constant that can then be imported to whatever needs it.\nOnce that was done, I moved into making sure everything worked in isolation and that is just simple as it sounds … create a test script that uses that particular service or pipeline. It was actually the interfaces that gave me the most problems because I never fully finished doing it in the first place and it was a bit of a pain to try and get Twitch working but I now have some type of developer console and it does output and log the chat so it works as intended. Doing this bit did make the next bit much easier.\nEverything has its’ place! Modular.\nIt just makes sense to me that these things should be modular and work when called upon. This is why I did really want NixOS to work well for me with the AI development (I’m still looking at it to create software development environments for other projects) because it’s creating that type of buffet setup where you have all these different tools and different versions and pick that one over there with a sprinkle of this … Like i said, it makes sense to me, so this is how I want the AI to also be operating.\nThis has been the conscious choice since bringing on the gameplay module and what has driven the requirement to refactor. The main LLM inference with the LLMRunner and prompt router sits away from anything else; the gameplay module has its own llm/ directory which has an adapter file in for logic specific to that module. This is also the case for the other integrated module that is in place and will continue to be the way the architecture is applied.\ngraph TD subgraph Home_AI H_infer[\"LLMRunner\"] H_edge_tts[\"Edge-TTS (optional)\"] end subgraph AI_Entertainer E_gameplay[\"Gameplay Module\"] E_llm_adapter[\"llm/adapter.py\"] E_runner[\"LLMRunner\"] E_prompt_builder[\"Prompt Builder\"] E_avatar[\"Avatar Integration\"] E_voice[\"Voice Pipeline\"] end H_infer --\u003e|Live Model Switching| H_edge_tts E_gameplay --\u003e E_prompt_builder E_prompt_builder --\u003e E_llm_adapter E_llm_adapter --\u003e E_runner E_runner --\u003e E_llm_adapter E_llm_adapter --\u003e E_voice E_voice --\u003e E_avatarTwo?! Now there are 2x agents that I have. The original home-AI that I was intending to create which has the LLM inference service with live model-switching capability and optional edge-tts and the AI Entertainer personality “Orielle” with the whole kit and caboodle. I am now planning to upload to my GitHub page the original home-AI version which can be reviewed and maybe even downloaded and tested your end if you have a spare 24GB of VRAM.\nThe refactor lifted a lot of mental weight and let me move forward. It was tempting at times to go too deep, but that’s the trap: thinking you must rewrite something just because you’ve learned a better way. Growth is good, but don’t punish yourself for past choices that still work. Smile at the “really?” moments and keep moving, especially if you’re working solo and learning as you grow.\nNext Dev Steps Refactor ticked off, AI personalities separated, full steam ahead on Orielle.\nThings feel a bit off with the gameplay loop so I need to spend a bit of time thinking about that and looking into what needs to change as it’s not clear to me at the moment but I just got that feeling that something is missing.\nEver onwards.\npiestyx\n","wordCount":"942","inLanguage":"en","datePublished":"2025-07-09T00:00:00Z","dateModified":"2025-07-09T00:00:00Z","author":{"@type":"Person","name":"piestyx"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://piestyx.dev/blog/devlog-03/"},"publisher":{"@type":"Organization","name":"piestyx.dev","logo":{"@type":"ImageObject","url":"https://piestyx.dev/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://piestyx.dev/ accesskey=h title="piestyx.dev (Alt + H)">piestyx.dev</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://piestyx.dev/packages/ title=Packages><span>Packages</span></a></li><li><a href=https://piestyx.dev/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://piestyx.dev/project_echo/ title=ECHO><span>ECHO</span></a></li><li><a href=https://piestyx.dev/playground/ title=Playground><span>Playground</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Strength from Unity, Conquest from Division</h1><div class=post-meta><span title='2025-07-09 00:00:00 +0000 UTC'>July 9, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;piestyx</div></header><div class=post-content><h2 id=the-refactor-traptor>The Refactor Traptor<a hidden class=anchor aria-hidden=true href=#the-refactor-traptor>#</a></h2><p>It is true that refactoring can sometimes be a trap because you don&rsquo;t actually gain anything from doing it aside from maybe tidying up some messy code or shaving fractions of a second somewhere. My refactor recently, though, was absolutely a value add and a necessity as it was taking up far too much mental bandwidth with a niggling thought in the back of my mind that it still needed to be done. I never intended for it all to be rolled in to one, I wanted to get a baseline together and then build on top of that in a copy so that I always had that baseline template to work off for anything new and I could then also keep that as a local working version instead of using the version that is designed for entertainment. Things iterated rapidly, though, and I didn&rsquo;t really pay too much attention until later on and it became apparent after a while that it would be best to bite the bullet and spend the time in doing it.</p><h2 id=creating-the-break>Creating The Break<a hidden class=anchor aria-hidden=true href=#creating-the-break>#</a></h2><p>As I had initially planned on just having a home-AI companion there were hard-coded file paths sitting all over the place, semi finished pieces that I then moved away from and only a semi-separation of concerns and modularity. I had some clear goals in mind for the refactor:</p><pre><code>1. No hard coded pathing - everything must use a `.env` file
2. Each element should work when used in isolation
3. Each element should act in a modular fashion where services such as inference are called when required
</code></pre><p>Fairly simple and logical, and is now a principle I am trying to take across every project because it just makes everything easier to maintain and to grow.</p><p>So I first went through and moved all pathing, secrets and auths into a <code>.env</code> with an accompanying <code>.env.example</code>. This act alone lifted a huge weight as there were so many different locations for it that it was getting difficult to manage and remember that one place where it might have directly pointed somewhere else. There&rsquo;s now 35 being tracked in there, which is a lot, but it&rsquo;s DRY as anything so i&rsquo;m still satisfied with it. To then propagate them through the development environment I use a single utility python file that loads the <code>.env</code> and provides a constant that can then be imported to whatever needs it.</p><p>Once that was done, I moved into making sure everything worked in isolation and that is just simple as it sounds … create a test script that uses that particular service or pipeline. It was actually the interfaces that gave me the most problems because I never fully finished doing it in the first place and it was a bit of a pain to try and get Twitch working but I now have some type of developer console and it does output and log the chat so it works as intended. Doing this bit did make the next bit much easier.</p><h2 id=everything-has-its-place>Everything has its&rsquo; place!<a hidden class=anchor aria-hidden=true href=#everything-has-its-place>#</a></h2><p>Modular.</p><p>It just makes sense to me that these things should be modular and work when called upon. This is why I did really want <a href=https://nixos.org/>NixOS</a> to work well for me with the AI development (I&rsquo;m still looking at it to create software development environments for other projects) because it&rsquo;s creating that type of buffet setup where you have all these different tools and different versions and pick that one over there with a sprinkle of this … Like i said, it makes sense to me, so this is how I want the AI to also be operating.</p><p>This has been the conscious choice since bringing on the gameplay module and what has driven the requirement to refactor. The main <code>LLM</code> inference with the <code>LLMRunner</code> and <code>prompt router</code> sits away from anything else; the gameplay module has its own <code>llm/</code> directory which has an adapter file in for logic specific to that module. This is also the case for the other integrated module that is in place and will continue to be the way the architecture is applied.</p><pre class=mermaid>graph TD
    subgraph Home_AI
        H_infer[&#34;LLMRunner&#34;]
        H_edge_tts[&#34;Edge-TTS (optional)&#34;]
    end

    subgraph AI_Entertainer
        E_gameplay[&#34;Gameplay Module&#34;]
        E_llm_adapter[&#34;llm/adapter.py&#34;]
        E_runner[&#34;LLMRunner&#34;]
        E_prompt_builder[&#34;Prompt Builder&#34;]
        E_avatar[&#34;Avatar Integration&#34;]
        E_voice[&#34;Voice Pipeline&#34;]
    end

    H_infer --&gt;|Live Model Switching| H_edge_tts
    E_gameplay --&gt; E_prompt_builder
    E_prompt_builder --&gt; E_llm_adapter
    E_llm_adapter --&gt; E_runner
    E_runner --&gt; E_llm_adapter
    E_llm_adapter --&gt; E_voice
    E_voice --&gt; E_avatar</pre><h2 id=two>Two?!<a hidden class=anchor aria-hidden=true href=#two>#</a></h2><p>Now there are 2x agents that I have. The original home-AI that I was intending to create which has the <code>LLM</code> inference service with live model-switching capability and optional <code>edge-tts</code> and the AI Entertainer personality &ldquo;Orielle&rdquo; with the whole kit and caboodle. I am now planning to upload to my GitHub page the original home-AI version which can be reviewed and maybe even downloaded and tested your end if you have a spare 24GB of VRAM.</p><p>The refactor lifted a lot of mental weight and let me move forward. It was tempting at times to go too deep, but that’s the trap: thinking you must rewrite something just because you’ve learned a better way. Growth is good, but don’t punish yourself for past choices that still work. Smile at the &ldquo;really?&rdquo; moments and keep moving, especially if you&rsquo;re working solo and learning as you grow.</p><h2 id=next-dev-steps>Next Dev Steps<a hidden class=anchor aria-hidden=true href=#next-dev-steps>#</a></h2><p>Refactor ticked off, AI personalities separated, full steam ahead on Orielle.</p><p>Things feel a bit off with the gameplay loop so I need to spend a bit of time thinking about that and looking into what needs to change as it&rsquo;s not clear to me at the moment but I just got that feeling that something is missing.</p><p>Ever onwards.</p><p>piestyx</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://piestyx.dev/tags/%23devlog/>#Devlog</a></li><li><a href=https://piestyx.dev/tags/%23echo/>#Echo</a></li></ul><nav class=paginav><a class=prev href=https://piestyx.dev/blog/devlog-04/><span class=title>« Prev</span><br><span>Hier kommt die Sonne!!</span>
</a><a class=next href=https://piestyx.dev/blog/blog-05/><span class=title>Next »</span><br><span>Mary's Mirror</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://piestyx.dev/>piestyx.dev</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>